<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>ë¬´í•œ íŒŒë”± ê°€ì± : í—¬ê²Œì´íŠ¸</title>
    <style>
        :root {
            --bg: #101010;
            --panel: #1a1a1a;
            --accent: #e67e22; /* DC Orange */
            --rare: #3498db;
            --epic: #9b59b6;
            --legend: #f1c40f;
            --trash: #7f8c8d;
            --danger: #e74c3c;
            --text: #ecf0f1;
        }

        * { box-sizing: border-box; user-select: none; }
        body {
            margin: 0; padding: 0; background: var(--bg); color: var(--text);
            font-family: 'Pretendard', sans-serif; height: 100vh; display: flex; flex-direction: column; overflow: hidden;
        }

        /* --- Header: Resources --- */
        header {
            background: #000; padding: 10px 15px; border-bottom: 2px solid #333;
            display: flex; justify-content: space-between; align-items: center; height: 60px;
        }
        .res-box { font-weight: bold; font-size: 1.1rem; }
        .cp-val { color: var(--legend); text-shadow: 0 0 5px rgba(241, 196, 15, 0.5); }
        .stress-bar-bg { width: 100px; height: 10px; background: #333; border-radius: 5px; display: inline-block; margin-left: 5px; overflow: hidden; vertical-align: middle; }
        .stress-bar-fill { height: 100%; background: var(--danger); width: 0%; transition: width 0.2s; }

        /* --- Main: Gacha & Slots --- */
        main { flex: 1; overflow-y: auto; padding: 15px; display: flex; flex-direction: column; gap: 15px; }

        /* Gacha Stage */
        .gacha-stage {
            background: radial-gradient(circle, #2c3e50, #000);
            border-radius: 12px; padding: 20px; text-align: center;
            border: 2px solid #444; position: relative; min-height: 200px;
            display: flex; flex-direction: column; justify-content: center; align-items: center;
        }
        .gacha-result {
            font-size: 1.5rem; font-weight: 900; margin-bottom: 10px; opacity: 0; transform: scale(0.5); transition: 0.3s;
        }
        .gacha-result.show { opacity: 1; transform: scale(1); }
        .gacha-desc { font-size: 0.9rem; color: #aaa; margin-bottom: 20px; min-height: 20px;}
        
        .gacha-btn {
            background: linear-gradient(45deg, #e67e22, #d35400);
            border: none; color: white; padding: 15px 50px; font-size: 1.2rem; font-weight: bold;
            border-radius: 50px; cursor: pointer; box-shadow: 0 5px 15px rgba(230, 126, 34, 0.4);
            transition: 0.1s; position: relative; overflow: hidden;
        }
        .gacha-btn:active { transform: scale(0.95); box-shadow: 0 2px 5px rgba(230, 126, 34, 0.4); }
        .gacha-btn:disabled { filter: grayscale(1); cursor: not-allowed; opacity: 0.5; }
        .cost-tag { display: block; font-size: 0.7rem; margin-top: 2px; color: #ffd; }

        /* Active Pasdak Slots */
        .slot-container {
            display: grid; grid-template-columns: repeat(2, 1fr); gap: 10px;
        }
        .pasdak-card {
            background: var(--panel); border-radius: 8px; padding: 10px; border: 1px solid #333;
            position: relative; overflow: hidden; transition: 0.2s;
        }
        .pasdak-card.SSR { border-color: var(--legend); box-shadow: inset 0 0 10px rgba(241, 196, 15, 0.2); }
        .pasdak-card.SR { border-color: var(--epic); }
        .pasdak-card.R { border-color: var(--rare); }
        .pasdak-card.F { border-color: var(--danger); background: #220a0a; }

        .p-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 5px; }
        .p-rank { font-weight: 900; font-size: 0.8rem; padding: 2px 6px; border-radius: 4px; color: #000; }
        .rank-N { background: var(--trash); } .rank-R { background: var(--rare); }
        .rank-SR { background: var(--epic); } .rank-SSR { background: var(--legend); } .rank-F { background: var(--danger); color: #fff; }
        
        .p-name { font-weight: bold; font-size: 0.9rem; }
        .p-stat { font-size: 0.75rem; color: #888; margin-top: 4px; }
        .p-action { font-size: 0.7rem; color: var(--accent); margin-top: 5px; height: 14px; overflow: hidden; white-space: nowrap; text-overflow: ellipsis; }

        .kick-btn {
            position: absolute; top: 5px; right: 5px;
            background: rgba(0,0,0,0.5); color: #fff; border: none; cursor: pointer;
            font-size: 0.7rem; padding: 2px 6px; border-radius: 4px;
        }
        .kick-btn:hover { background: var(--danger); }

        /* --- Footer: Logs --- */
        footer {
            height: 200px; background: #000; border-top: 2px solid #333;
            padding: 10px; overflow-y: auto; font-family: 'D2Coding', monospace; font-size: 0.85rem;
        }
        .log-line { margin-bottom: 4px; border-bottom: 1px solid #1a1a1a; padding-bottom: 2px; }
        .t-sys { color: #7f8c8d; }
        .t-get { color: var(--legend); font-weight: bold; }
        .t-ban { color: var(--danger); }
        .t-fight { color: var(--accent); }
        .t-work { color: var(--rare); }

        /* Floating Text */
        .float-txt {
            position: absolute; font-weight: bold; font-size: 1.2rem; pointer-events: none;
            animation: floatUp 0.8s forwards; z-index: 100; text-shadow: 0 0 3px #000;
        }
        @keyframes floatUp { 0% { transform: translateY(0) scale(1); opacity: 1; } 100% { transform: translateY(-50px) scale(1.2); opacity: 0; } }

        /* Overlay */
        #gameover {
            position: fixed; inset: 0; background: rgba(0,0,0,0.95); z-index: 999;
            display: none; flex-direction: column; justify-content: center; align-items: center; text-align: center;
        }
        .go-title { font-size: 3rem; color: var(--danger); margin-bottom: 20px; font-weight: 900; }
    </style>
</head>
<body>

    <header>
        <div class="res-box">
            ğŸ’ <span id="cp-display" class="cp-val">0</span> CP
        </div>
        <div class="res-box" style="font-size:0.9rem;">
            ê°¤ëŸ¬ë¦¬ ë©˜íƒˆ
            <div class="stress-bar-bg"><div id="stress-bar" class="stress-bar-fill"></div></div>
        </div>
    </header>

    <main>
        <div class="gacha-stage">
            <div id="gacha-result-text" class="gacha-result">íŒŒë”±ì„ ë½‘ì•„ë³´ì„¸ìš”!</div>
            <div id="gacha-desc-text" class="gacha-desc">í›Œë¥­í•œ ë…¸ì˜ˆê°€ í•„ìš”í•©ë‹ˆë‹¤.</div>
            <button id="pull-btn" class="gacha-btn" onclick="game.pull()">
                íŒŒë”± ì†Œí™˜
                <span class="cost-tag" id="cost-tag">100 CP</span>
            </button>
        </div>

        <div style="display:flex; justify-content:space-between; align-items:center;">
            <span style="font-weight:bold; color:#aaa;">í˜„ì¬ ì™„ì¥ ë¼ì¸ì—… (<span id="slot-count">0</span>/6)</span>
            <span style="font-size:0.8rem; color:#666;">ìë™ìœ¼ë¡œ ì¼í•˜ê³  ì‹¸ì›ë‹ˆë‹¤.</span>
        </div>

        <div id="slot-area" class="slot-container">
            </div>
    </main>

    <footer id="log-area">
        <div class="log-line t-sys">> ì‹œìŠ¤í…œ ê°€ë™. íŒŒë”±ì„ ë½‘ì•„ ê°¤ëŸ¬ë¦¬ë¥¼ ë°©ì–´í•˜ì„¸ìš”.</div>
    </footer>

    <div id="gameover">
        <div class="go-title">ê°¤ëŸ¬ë¦¬ í­íŒŒ</div>
        <p style="color:#ccc; margin-bottom:30px;">íŒŒë”±ë“¤ì´ ê°¤ëŸ¬ë¦¬ë¥¼ ë‹¤ í„°ëœ¨ë ¸ìŠµë‹ˆë‹¤.</p>
        <button class="gacha-btn" onclick="location.reload()">ìƒˆ ì§€êµ¬ íŒŒê¸°</button>
    </div>

<script>
/**
 * DATA: Pasdak Database
 */
const DATA = {
    ranks: ['N', 'R', 'SR', 'SSR', 'F'],
    names: {
        prefixes: ['ìƒˆë²½ë°˜', 'ìœ ë™', 'ê³ ë‹‰', 'ë„¤ì„ë“œ', 'ë°±ìˆ˜', 'ì—¬ê³ ìƒ', 'ì»¨ì…‰ì¶©', 'ë§ë ¹', 'AI', 'ì¼ë¯¼ì´'],
        suffixes: ['ìœ¾ë™', 'ë¹ŒëŸ°', 'ì£¼ë”±', 'ë…¸ì˜ˆ', 'í•«ì‚°', 'ë´‡', 'ì €ê²©ìˆ˜', 'í†µí”¼', 'ë°•ì œëŸ¬', 'ë„ë°°ê¸°']
    },
    jobs: {
        N: ['ëˆˆíŒ…ì¡±', 'ëŒ“ê¸€ë´‡', 'ê°œì¶”ë¨¸ì‹ ', 'í•‘í”„'],
        R: ['ì§¤ìŸì´', 'ë²ˆì—­í•«ì‚°', 'ì •ë³´ê²Œì´', 'ë‰´ìŠ¤ë´‡'],
        SR: ['24ì‹œê°„ìƒì£¼', 'ë§¤í¬ë¡œ', 'ë¶€ê²€ì „ë¬¸ê°€', 'ì½”ë“œìŠ¬ë ˆì´ì–´'],
        SSR: ['ê¹€ìœ ì‹ì¡°ì¹´', 'ì„œë²„ê´€ë¦¬ì', 'ì•Œë°”', 'ë¹›ì˜ì™„ì¥'],
        F: ['ë¶„íƒ•ì¶©', 'íƒ€ê°¤ì²©ì', 'ì¢†ëª©ëŒ€ì¥', 'ê¶Œë ¥ë‚¨ìš©']
    },
    logs: {
        work: ["ê´‘ê³ ê¸€ ì‚­ì œ", "ì•¼ì§¤ ì»·", "ë„ë°° ì°¨ë‹¨", "í• ì¹´ìŠ¤ ì œê±°", "ì‹¤ë² ê¸€ ë°©ì–´", "ë¶„íƒ• VPN ì°¨ë‹¨", "ì •ë³´ê¸€ ë…ê¸€í–‰", "ê³µì§€ ê°±ì‹ "],
        fight: ["ì„œë¡œ 30ì¼ ì°¨ë‹¨", "ì €ê²©ê¸€ ì‘ì„±", "ê³¼ê±°ê¸€ í„¸ê¸°", "ì‹ ìƒ í„¸ê¸°", "ê³ ì†Œ í˜‘ë°•", "í‚¤ë³´ë“œ ë°°í‹€", "í˜„í”¼ ì‹ ì²­"],
        idle: ["ê°¤ì§ˆ ì¤‘...", "ìƒˆë¡œê³ ì¹¨ ì¤‘...", "ì˜ ìëŠ” ì¤‘...", "ë¼ë©´ ë¨¹ëŠ” ì¤‘...", "ì• ë‹ˆ ë³´ëŠ” ì¤‘...", "í˜„íƒ€ ì˜´"]
    }
};

class Pasdak {
    constructor() {
        this.rank = this.rollRank();
        this.name = this.genName();
        this.job = this.genJob(this.rank);
        this.power = this.getPower(this.rank); // CP earning
        this.chaos = this.getChaos(this.rank); // Chance to fight
        this.id = Math.random().toString(36).substr(2, 9);
    }

    rollRank() {
        const r = Math.random() * 100;
        if (r < 5) return 'SSR';  // 5%
        if (r < 15) return 'F';   // 10% (Trap)
        if (r < 30) return 'SR';  // 15%
        if (r < 60) return 'R';   // 30%
        return 'N';               // 40%
    }

    genName() {
        const p = DATA.names.prefixes[Math.floor(Math.random() * DATA.names.prefixes.length)];
        const s = DATA.names.suffixes[Math.floor(Math.random() * DATA.names.suffixes.length)];
        const num = Math.floor(Math.random() * 999);
        return `${p}${s}(${num})`;
    }

    genJob(rank) {
        const list = DATA.jobs[rank];
        return list[Math.floor(Math.random() * list.length)];
    }

    getPower(rank) {
        if(rank==='SSR') return 50;
        if(rank==='SR') return 20;
        if(rank==='R') return 10;
        if(rank==='F') return -10; // F loses money
        return 5;
    }

    getChaos(rank) {
        if(rank==='F') return 80; // High fight chance
        if(rank==='SSR') return 0;
        return 10;
    }
}

class Game {
    constructor() {
        this.cp = 200; // Starting money
        this.stress = 0; // 0 to 100
        this.pasdaks = [];
        this.maxSlots = 6;
        this.cost = 100;
        this.isOver = false;
        
        this.ui = {
            cp: document.getElementById('cp-display'),
            stress: document.getElementById('stress-bar'),
            slots: document.getElementById('slot-area'),
            logs: document.getElementById('log-area'),
            result: document.getElementById('gacha-result-text'),
            desc: document.getElementById('gacha-desc-text'),
            btn: document.getElementById('pull-btn'),
            cost: document.getElementById('cost-tag'),
            count: document.getElementById('slot-count')
        };

        this.startLoop();
    }

    updateUI() {
        this.ui.cp.innerText = Math.floor(this.cp);
        this.ui.stress.style.width = this.stress + '%';
        this.ui.cost.innerText = `${this.cost} CP`;
        this.ui.count.innerText = this.pasdaks.length;
        
        this.ui.btn.disabled = this.cp < this.cost || this.pasdaks.length >= this.maxSlots;
        if(this.pasdaks.length >= this.maxSlots) this.ui.cost.innerText = "ìŠ¬ë¡¯ ê°€ë“ì°¸";
    }

    pull() {
        if(this.cp < this.cost) return;
        if(this.pasdaks.length >= this.maxSlots) return;

        this.cp -= this.cost;
        this.cost = Math.floor(this.cost * 1.2); // Inflation
        
        const p = new Pasdak();
        this.pasdaks.push(p);
        
        // Show Animation
        this.ui.result.className = 'gacha-result';
        void this.ui.result.offsetWidth; // Trigger reflow
        this.ui.result.innerText = `[${p.rank}] ${p.name}`;
        this.ui.result.className = 'gacha-result show';
        
        this.ui.result.style.color = this.getColor(p.rank);
        this.ui.desc.innerText = `<${p.job}> ì˜ì… ì„±ê³µ!`;

        this.renderSlots();
        this.log(`ê°€ì±  ê²°ê³¼: [${p.rank}] ${p.name} (${p.job}) íšë“!`, 't-get');
        this.updateUI();
    }

    kick(id) {
        const idx = this.pasdaks.findIndex(p => p.id === id);
        if(idx > -1) {
            const p = this.pasdaks[idx];
            this.log(`[${p.name}]ì„(ë¥¼) ì™„ì¥ í•´ì œí–ˆìŠµë‹ˆë‹¤.`, 't-ban');
            this.pasdaks.splice(idx, 1);
            this.cost = Math.max(100, Math.floor(this.cost * 0.9)); // Reduce cost slightly
            this.renderSlots();
            this.updateUI();
        }
    }

    renderSlots() {
        this.ui.slots.innerHTML = '';
        this.pasdaks.forEach(p => {
            const div = document.createElement('div');
            div.className = `pasdak-card ${p.rank}`;
            div.id = `card-${p.id}`;
            div.innerHTML = `
                <div class="p-header">
                    <span class="p-rank rank-${p.rank}">${p.rank}</span>
                    <button class="kick-btn" onclick="game.kick('${p.id}')">X</button>
                </div>
                <div class="p-name">${p.name}</div>
                <div class="p-stat">${p.job} | ì „íˆ¬ë ¥:${p.power}</div>
                <div class="p-action" id="act-${p.id}">ëŒ€ê¸° ì¤‘...</div>
            `;
            this.ui.slots.appendChild(div);
        });
    }

    startLoop() {
        setInterval(() => {
            if(this.isOver) return;
            this.tick();
        }, 1000); // Every 1 sec
    }

    tick() {
        if(this.pasdaks.length === 0) return;

        let totalPower = 0;
        
        this.pasdaks.forEach(p => {
            // 1. Action Check
            const roll = Math.random() * 100;
            const actEl = document.getElementById(`act-${p.id}`);
            
            if(roll < p.chaos) {
                // Trouble (Fight)
                this.handleFight(p);
            } else {
                // Work (Earn CP)
                const earn = p.power;
                totalPower += earn;
                if(actEl) actEl.innerText = this.getRandomLog('work');
                this.showFloat(earn > 0 ? `+${earn}` : `${earn}`, p.id, earn > 0 ? '#2ecc71' : '#e74c3c');
            }
        });

        // Global Calculation
        this.cp += totalPower;
        
        // Stress Logic (Based on F ranks)
        const trolls = this.pasdaks.filter(p => p.rank === 'F').length;
        this.stress += trolls * 2; 
        if(totalPower < 0) this.stress += 5; // Negative income stress
        this.stress = Math.max(0, this.stress - (this.pasdaks.length > 0 ? 1 : 0)); // Natural heal

        if(this.stress >= 100) this.gameOver();
        
        this.updateUI();
    }

    handleFight(p) {
        if(this.pasdaks.length < 2) return;
        
        // Pick a random target
        const target = this.pasdaks[Math.floor(Math.random() * this.pasdaks.length)];
        if(target.id === p.id) return; // Don't fight self

        const msg = this.getRandomLog('fight');
        this.log(`[${p.name}] â–¶ [${target.name}]: ${msg}`, 't-fight');
        
        // Effect: Stress up
        this.stress += 5;
        document.getElementById(`act-${p.id}`).innerText = "ğŸ¤¬ í‚¤ë°° ëœ¨ëŠ” ì¤‘";
        
        // Randomly ban target (Kick)
        if(Math.random() < 0.1 && p.rank === 'F') { // F ranks are dangerous
            this.log(`ğŸš¨ [${p.name}]ì´(ê°€) [${target.name}]ì„(ë¥¼) ì°¨ë‹¨í•´ë²„ë ¸ìŠµë‹ˆë‹¤!`, 't-ban');
            this.kick(target.id);
        }
    }

    getRandomLog(type) {
        const list = DATA.logs[type];
        return list[Math.floor(Math.random() * list.length)];
    }

    log(msg, cls) {
        const div = document.createElement('div');
        div.className = `log-line ${cls}`;
        div.innerText = msg;
        this.ui.logs.appendChild(div);
        this.ui.logs.scrollTop = this.ui.logs.scrollHeight;
    }

    getColor(rank) {
        if(rank==='SSR') return '#f1c40f';
        if(rank==='SR') return '#9b59b6';
        if(rank==='R') return '#3498db';
        if(rank==='F') return '#e74c3c';
        return '#fff';
    }

    showFloat(txt, id, color) {
        const card = document.getElementById(`card-${id}`);
        if(!card) return;
        
        const el = document.createElement('div');
        el.className = 'float-txt';
        el.innerText = txt;
        el.style.color = color;
        el.style.left = '50%';
        el.style.top = '20%';
        el.style.transform = 'translate(-50%, -50%)';
        
        card.appendChild(el);
        setTimeout(() => el.remove(), 800);
    }

    gameOver() {
        this.isOver = true;
        document.getElementById('gameover').style.display = 'flex';
    }
}

const game = new Game();
</script>
</body>
</html>
